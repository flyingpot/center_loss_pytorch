# center_loss_pytorch

## Introduction

This is an Pytorch implementation of center loss. Some codes are from the repository [MNIST_center_loss_pytorch](https://github.com/jxgu1016/MNIST_center_loss_pytorch).

[Here](https://fanjingbo.com/pytorch/center-loss%E7%9A%84pytorch%E5%AE%9E%E7%8E%B0/) is an article about the code.

## Usage

You should use centerloss like this in your training file.

```python
# Creat an instance of CenterLoss
centerloss = CenterLoss(10, 48, 0.1)
# Get the loss and centers params
loss_center, params_grad = centerloss(targets, features)
# Calculate all gradients
loss_center.backward()
# Reset gradients(generated by autograd) in center params
centerloss.zero_grad()
# Manually assign centers gradients other than using autograd
centerloss.centers.backward(params_grad)
```
